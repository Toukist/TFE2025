<!-- Navbar unifiée pour tous les rôles, avec bouton déconnexion visible -->
<nav class="bg-white shadow px-6 py-3 flex items-center justify-between w-full">
  <!-- Logo & Navigation -->
  <div class="flex items-center gap-8">
    <!-- Logo dynamique selon le rôle -->
    <a [routerLink]="getHomeUrl()" class="text-xl font-bold text-gray-800 hover:text-red-600 transition-colors">
      <span *ngIf="getCurrentRoleName() === 'admin'">Dior Admin</span>
      <span *ngIf="getCurrentRoleName() === 'manager'">Dior Manager</span>
      <span *ngIf="getCurrentRoleName() === 'rh'">Dior RH</span>
      <span *ngIf="getCurrentRoleName() === 'operateur'">Dior Opérateur</span>
      <span *ngIf="!getCurrentRoleName()">Dior</span>
    </a>
    <ul class="flex items-center gap-6">
      <!-- Liens Admin -->
      <li *ngIf="getCurrentRoleName() === 'admin'">
        <a routerLink="/admin/users" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Utilisateurs</a>
      </li>
      <li *ngIf="getCurrentRoleName() === 'admin'">
        <a routerLink="/admin/audit-log" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Journal d'audit</a>
      </li>
      <li *ngIf="getCurrentRoleName() === 'admin'">
        <a routerLink="/admin/roles" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Rôles</a>
      </li>
      <li *ngIf="getCurrentRoleName() === 'admin'">
        <a routerLink="/admin/settings" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Paramètres</a>
      </li>
      <!-- Liens Manager -->
      <li *ngIf="getCurrentRoleName() === 'manager'">
        <a routerLink="/manager" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Dashboard Manager</a>
      </li>
      <li *ngIf="getCurrentRoleName() === 'manager'">
        <a routerLink="/manager/equipe" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Mon Équipe</a>
      </li>
      <li *ngIf="getCurrentRoleName() === 'manager'">
        <a routerLink="/manager/projets" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Projets</a>
      </li>
      <li *ngIf="getCurrentRoleName() === 'manager'">
        <a routerLink="/manager/performance" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Performance</a>
      </li>
      <!-- Liens RH -->
      <li *ngIf="getCurrentRoleName() === 'rh'">
        <a routerLink="/rh" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Dashboard RH</a>
      </li>
      <li *ngIf="getCurrentRoleName() === 'rh'">
        <a routerLink="/rh/evaluations" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Évaluations</a>
      </li>
      <!-- Liens Opérateur -->
      <li *ngIf="getCurrentRoleName() === 'operateur'">
        <a routerLink="/operateur" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Dashboard Opérateur</a>
      </li>
      <li *ngIf="getCurrentRoleName() === 'operateur'">
        <a routerLink="/operateur/agenda" routerLinkActive="text-red-600 border-b-2 border-red-600"
           class="text-gray-700 hover:text-red-600 transition-colors py-2 px-1">Agenda</a>
      </li>
    </ul>
  </div>
  <!-- Menu utilisateur enrichi -->
  <div *ngIf="currentUser$ | async as currentUser" class="relative">
    <button (click)="toggleMenu()" class="flex items-center gap-2 px-4 py-2 rounded-full bg-red-50 border border-red-200 hover:bg-red-100 transition focus:outline-none focus:ring-2 focus:ring-red-200 shadow" aria-haspopup="true" [attr.aria-expanded]="menuOpen">
      <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-red-200 text-red-700 font-bold text-lg border border-red-300">
  {{ (currentUser.firstName.charAt(0) || 'U') }}
      </span>
      <span class="font-semibold text-gray-800 ml-2">{{ currentUser.firstName }} {{ currentUser.lastName }}</span>
      <span class="text-xs text-gray-500 bg-gray-200 rounded px-2 py-0.5 ml-2" *ngIf="currentRole$ | async as currentRole">{{ currentRole.name || 'Aucun rôle' }}</span>
      <svg class="w-5 h-5 ml-2 text-gray-500" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"/>
      </svg>
    </button>
    <!-- Dropdown -->
    <div *ngIf="menuOpen" class="absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50 animate-fade-in">
      <div class="p-4 border-b">
  <p class="text-sm font-semibold">{{ currentUser.firstName }} {{ currentUser.lastName }}</p>
        <span class="text-xs text-gray-500">Rôle actuel : 
          <span class="font-semibold text-red-600" *ngIf="currentRole$ | async as currentRole">{{ currentRole.name || 'Aucun rôle' }}</span>
        </span>
      </div>
      <!-- Section Mes coordonnées -->
      <div class="p-4 border-b">
        <h4 class="text-sm font-semibold text-gray-700 mb-2">Mes coordonnées</h4>
        <div class="space-y-1">
          <p class="text-xs text-gray-600">Nom d'utilisateur : {{ currentUser.name || 'Non défini' }}</p>
          <p class="text-xs text-gray-600">Nom complet : {{ currentUser.firstName }} {{ currentUser.lastName }}</p>
          <p class="text-xs text-gray-600">Statut : {{ currentUser.isActive ? 'Actif' : 'Inactif' }}</p>
        </div>
        <a routerLink="/mes-coordonnees" class="block mt-3 text-xs text-blue-600 hover:underline font-semibold">
          Voir mes coordonnées
        </a>
      </div>
      <div class="p-2 border-t text-center">
        <button (click)="logout()" class="text-sm text-red-500 hover:text-red-700 font-semibold">Déconnexion</button>
      </div>
    </div>
  </div>
</nav>
