<div class="choix-role-container" *ngIf="currentUser$ | async as currentUser">
  <div class="header-container">
    <h1 class="main-title">S茅lectionnez Votre R么le</h1>
    <p class="welcome-message" *ngIf="currentUser">
      Bonjour <strong>{{ currentUser.firstName }} {{ currentUser.lastName }}</strong>,
      <span *ngIf="(userRoles$ | async) as userRoles">vous avez acc猫s  <strong *ngIf="userRoles">{{ (userRoles?.length || 0) }}</strong> r么le{{ (userRoles?.length || 0) > 1 ? 's' : '' }}.</span>
    </p>
    <p class="instructions">
      Veuillez choisir le r么le avec lequel vous souhaitez acc茅der  l'application.
      Chaque r么le vous donnera acc猫s  des fonctionnalit茅s sp茅cifiques.
    </p>
  </div>

  <div *ngIf="isLoading$ | async" class="loading-indicator">
    <p>Chargement des r么les...</p>
    <div class="spinner"></div>
  </div>

  <ng-container *ngIf="(userRoles$ | async) as userRoles">
    <div class="roles-grid" *ngIf="userRoles && userRoles.length > 0 && (isLoading$ | async) === false">
      <div class="role-card"
           *ngFor="let role of userRoles; let i = index"
           tabindex="0"
           [class.loading]="(isLoading$ | async) === true"
           [attr.aria-label]="'S茅lectionner le r么le ' + role.name"
           (click)="selectRoleAndNavigate(role.name)"
           (keydown.enter)="selectRoleAndNavigate(role.name)"
           (keydown.space)="selectRoleAndNavigate(role.name)">        <div class="role-icon">{{ getRoleIcon(role.name) }}</div>
        <h3 class="role-name">{{ role.name }}</h3>
        <p class="role-description">{{ getRoleDescription(role.name) }}</p>
        <button class="select-button" [disabled]="isLoading$ | async">
            <span *ngIf="(isLoading$ | async) === false">Acc茅der en tant que {{ role.name }}</span>
            <span *ngIf="isLoading$ | async"> Chargement...</span>
        </button>
      </div>
    </div>

    <div class="no-roles" *ngIf="userRoles && userRoles.length === 0 && (isLoading$ | async) === false">
      <p></p>
      <p>Aucun r么le ne vous est actuellement attribu茅 ou vos r么les ne sont pas encore charg茅s.</p>
      <p>Si vous pensez qu'il s'agit d'une erreur, veuillez contacter l'administrateur.</p>
    </div>

    <div class="loading-state" *ngIf="(isLoading$ | async) && (!userRoles || userRoles.length === 0)">
      <p> V茅rification de vos acc猫s en cours...</p>
      <p>Merci de patienter.</p>
    </div>
  </ng-container>
  <div class="footer-actions">
    <button (click)="logout()" class="logout-button" [disabled]="isLoading$ | async">
      <span *ngIf="(isLoading$ | async) === false">D茅connexion</span>
      <span *ngIf="isLoading$ | async"> D茅connexion...</span>
    </button>
  </div>
</div>
